{
  "title": "Shadow API Actor Input",
  "type": "object",
  "schemaVersion": 1,
  "properties": {
    "host": {
      "title": "Host",
      "type": "string",
      "description": "HTTP bind host.",
      "default": "0.0.0.0"
    },
    "port": {
      "title": "Port",
      "type": "integer",
      "description": "HTTP bind port.",
      "default": 3000
    },
    "logLevel": {
      "title": "Log level",
      "type": "string",
      "description": "Application log level.",
      "default": "INFO",
      "enum": [
        "DEBUG",
        "INFO",
        "WARNING",
        "ERROR"
      ]
    },
    "logRedactionEnabled": {
      "title": "Log redaction enabled",
      "type": "boolean",
      "description": "Redact secrets/PII-like fields from operational logs.",
      "default": true
    },
    "requiredEnvVars": {
      "title": "Required env vars",
      "type": "array",
      "description": "Environment variable names that must be present at startup.",
      "editor": "stringList",
      "prefill": []
    },
    "apiKeyEnabled": {
      "title": "API key auth enabled",
      "type": "boolean",
      "description": "Require API key on protected API endpoints.",
      "default": false
    },
    "apiKey": {
      "title": "API key",
      "type": "string",
      "description": "Expected API key value for `x-api-key` or Bearer auth.",
      "default": "",
      "isSecret": true
    },
    "hmacSigningEnabled": {
      "title": "HMAC signing enabled",
      "type": "boolean",
      "description": "Require request signatures on protected endpoints.",
      "default": false
    },
    "hmacSecrets": {
      "title": "HMAC secrets",
      "type": "array",
      "description": "List of shared secrets used to validate request signatures (supports rotation).",
      "editor": "stringList",
      "prefill": [],
      "isSecret": true
    },
    "hmacMaxSkewSec": {
      "title": "HMAC max skew (sec)",
      "type": "integer",
      "description": "Allowed client/server clock skew window in seconds.",
      "default": 300
    },
    "hmacSignatureHeader": {
      "title": "HMAC signature header",
      "type": "string",
      "description": "Header name used for request signature.",
      "default": "x-shadow-signature"
    },
    "hmacTimestampHeader": {
      "title": "HMAC timestamp header",
      "type": "string",
      "description": "Header name used for request timestamp (unix seconds).",
      "default": "x-shadow-timestamp"
    },
    "rateLimitEnabled": {
      "title": "Rate limiting enabled",
      "type": "boolean",
      "description": "Enable in-memory rate limiting by global/ip/api-key buckets.",
      "default": false
    },
    "rateLimitWindowMs": {
      "title": "Rate limit window (ms)",
      "type": "integer",
      "description": "Window size used for fixed-window counters.",
      "default": 10000
    },
    "rateLimitGlobalMax": {
      "title": "Rate limit global max",
      "type": "integer",
      "description": "Max requests per window across the whole service.",
      "default": 250
    },
    "rateLimitIpMax": {
      "title": "Rate limit IP max",
      "type": "integer",
      "description": "Max requests per window per client IP.",
      "default": 150
    },
    "rateLimitApiKeyMax": {
      "title": "Rate limit API key max",
      "type": "integer",
      "description": "Max requests per window per API key (when provided).",
      "default": 250
    },
    "browserPoolEnabled": {
      "title": "Browser pool enabled",
      "type": "boolean",
      "description": "Enable Playwright warm browser pool.",
      "default": true
    },
    "browserPoolSize": {
      "title": "Browser pool size",
      "type": "integer",
      "description": "Number of warm sessions to keep.",
      "default": 1
    },
    "browserHeadless": {
      "title": "Browser headless",
      "type": "boolean",
      "description": "Run browser in headless mode.",
      "default": true
    },
    "browserLaunchTimeoutMs": {
      "title": "Browser launch timeout (ms)",
      "type": "integer",
      "description": "Playwright browser launch timeout in milliseconds.",
      "default": 30000
    },
    "browserOptimizedFlagsEnabled": {
      "title": "Browser optimized flags enabled",
      "type": "boolean",
      "description": "Enable performance-oriented browser launch/context flags.",
      "default": true
    },
    "browserBlockResources": {
      "title": "Browser block resources",
      "type": "boolean",
      "description": "Block image/font/media requests in warm contexts to reduce overhead.",
      "default": true
    },
    "standbyEnabled": {
      "title": "Standby lifecycle enabled",
      "type": "boolean",
      "description": "Enable standby lifecycle manager for warm sessions.",
      "default": true
    },
    "standbyIdleTimeoutMs": {
      "title": "Standby idle timeout (ms)",
      "type": "integer",
      "description": "Switch to standby mode after this idle duration.",
      "default": 60000
    },
    "standbyTickIntervalMs": {
      "title": "Standby tick interval (ms)",
      "type": "integer",
      "description": "Lifecycle loop interval in milliseconds.",
      "default": 10000
    },
    "standbyRecycleAfterMs": {
      "title": "Session recycle age (ms)",
      "type": "integer",
      "description": "Recycle warm sessions older than this age.",
      "default": 900000
    },
    "sessionStorageEnabled": {
      "title": "Session storage enabled",
      "type": "boolean",
      "description": "Persist and recover browser session state across actor runs.",
      "default": true
    },
    "sessionStoreName": {
      "title": "Session store name",
      "type": "string",
      "description": "Apify Key-Value store name used for persisted session state.",
      "default": "SHADOW_API_SESSIONS"
    },
    "sessionStoreKeyPrefix": {
      "title": "Session store key prefix",
      "type": "string",
      "description": "Prefix for persisted session slot keys.",
      "default": "session-slot"
    },
    "sessionStorageRetentionMs": {
      "title": "Session storage retention (ms)",
      "type": "integer",
      "description": "Expire persisted session slots older than this age (0 disables expiry).",
      "default": 604800000
    },
    "requestQueueConcurrency": {
      "title": "Request queue concurrency",
      "type": "integer",
      "description": "Maximum number of queued tasks processed in parallel.",
      "default": 2
    },
    "requestQueueMaxSize": {
      "title": "Request queue max size",
      "type": "integer",
      "description": "Maximum queued tasks before backpressure rejection.",
      "default": 100
    },
    "requestQueueTaskTimeoutMs": {
      "title": "Request queue task timeout (ms)",
      "type": "integer",
      "description": "Max time per queued task before timeout.",
      "default": 15000
    },
    "fetchTimeoutDefaultMs": {
      "title": "Fetch timeout default (ms)",
      "type": "integer",
      "description": "Default timeout for `POST /v1/fetch` when request omits `timeout_ms`.",
      "default": 8000
    },
    "fetchTimeoutMinMs": {
      "title": "Fetch timeout min (ms)",
      "type": "integer",
      "description": "Minimum accepted `timeout_ms` for `POST /v1/fetch`.",
      "default": 1000
    },
    "fetchTimeoutMaxMs": {
      "title": "Fetch timeout max (ms)",
      "type": "integer",
      "description": "Maximum accepted `timeout_ms` for `POST /v1/fetch`.",
      "default": 15000
    },
    "requestBodyMaxBytes": {
      "title": "Request body max bytes",
      "type": "integer",
      "description": "Maximum JSON body size accepted by API endpoints.",
      "default": 1000000
    },
    "cacheProvider": {
      "title": "Cache provider",
      "type": "string",
      "description": "Cache backend for hot-path responses.",
      "default": "memory",
      "enum": [
        "memory",
        "redis"
      ]
    },
    "cacheTtlMs": {
      "title": "Cache TTL (ms)",
      "type": "integer",
      "description": "Fresh cache time-to-live for responses.",
      "default": 120000
    },
    "cacheStaleTtlMs": {
      "title": "Cache stale TTL (ms)",
      "type": "integer",
      "description": "Additional stale window for stale-while-revalidate responses.",
      "default": 300000
    },
    "cacheSwrEnabled": {
      "title": "Cache SWR enabled",
      "type": "boolean",
      "description": "Enable stale-while-revalidate behavior for expired entries.",
      "default": true
    },
    "redisUrl": {
      "title": "Redis URL",
      "type": "string",
      "description": "Redis connection URL when cache provider is redis.",
      "default": "",
      "isSecret": true
    },
    "redisKeyPrefix": {
      "title": "Redis key prefix",
      "type": "string",
      "description": "Prefix used for Redis cache keys.",
      "default": "shadow-api:cache"
    },
    "fastModeEnabled": {
      "title": "Fast mode enabled",
      "type": "boolean",
      "description": "Allow partial fast responses with limited field sets.",
      "default": true
    },
    "fastModeMaxFields": {
      "title": "Fast mode max fields",
      "type": "integer",
      "description": "Max number of fields returned when fast mode is enabled.",
      "default": 3
    },
    "prewarmEnabled": {
      "title": "Prewarm enabled",
      "type": "boolean",
      "description": "Enable periodic target prewarming jobs.",
      "default": false
    },
    "prewarmIntervalMs": {
      "title": "Prewarm interval (ms)",
      "type": "integer",
      "description": "Interval for prewarm scheduler runs.",
      "default": 30000
    },
    "prewarmTargets": {
      "title": "Prewarm targets",
      "type": "array",
      "description": "Target requests to refresh into cache proactively.",
      "items": {
        "type": "object"
      },
      "editor": "json",
      "prefill": []
    },
    "proxyRotationEnabled": {
      "title": "Proxy rotation enabled",
      "type": "boolean",
      "description": "Enable rotating proxy strategy for outbound fetches.",
      "default": false
    },
    "proxyPoolUrls": {
      "title": "Proxy pool URLs",
      "type": "array",
      "description": "List of proxy URLs used by the rotation pool.",
      "editor": "stringList",
      "prefill": []
    },
    "proxyQuarantineMs": {
      "title": "Proxy quarantine (ms)",
      "type": "integer",
      "description": "Quarantine duration when a proxy is flagged as blocked.",
      "default": 300000
    },
    "fingerprintRotationEnabled": {
      "title": "Fingerprint rotation enabled",
      "type": "boolean",
      "description": "Rotate user-agent and browser fingerprint profiles.",
      "default": true
    },
    "retryMaxAttempts": {
      "title": "Retry max attempts",
      "type": "integer",
      "description": "Maximum attempts for adaptive retry policy.",
      "default": 3
    },
    "retryBaseDelayMs": {
      "title": "Retry base delay (ms)",
      "type": "integer",
      "description": "Base delay for exponential retry backoff.",
      "default": 200
    },
    "retryMaxDelayMs": {
      "title": "Retry max delay (ms)",
      "type": "integer",
      "description": "Maximum delay allowed by retry backoff policy.",
      "default": 5000
    },
    "retryBlockedDelayMs": {
      "title": "Retry blocked delay (ms)",
      "type": "integer",
      "description": "Delay used for blocked/challenge retry attempts.",
      "default": 1500
    },
    "retryJitterMs": {
      "title": "Retry jitter (ms)",
      "type": "integer",
      "description": "Random jitter added to retry delays.",
      "default": 250
    },
    "circuitBreakerEnabled": {
      "title": "Circuit breaker enabled",
      "type": "boolean",
      "description": "Enable per-source circuit breaker protection.",
      "default": true
    },
    "circuitFailureThreshold": {
      "title": "Circuit failure threshold",
      "type": "integer",
      "description": "Consecutive failures before circuit opens.",
      "default": 5
    },
    "circuitOpenMs": {
      "title": "Circuit open duration (ms)",
      "type": "integer",
      "description": "Duration to keep a circuit open before half-open trial.",
      "default": 60000
    },
    "circuitHalfOpenSuccessThreshold": {
      "title": "Circuit half-open success threshold",
      "type": "integer",
      "description": "Successes required in half-open to close a circuit.",
      "default": 2
    },
    "sourceQuarantineMs": {
      "title": "Source quarantine (ms)",
      "type": "integer",
      "description": "Quarantine duration for blocked sources.",
      "default": 300000
    },
    "fallbackUrlStrategyEnabled": {
      "title": "Fallback URL strategy enabled",
      "type": "boolean",
      "description": "Enable source-specific fallback URL strategies.",
      "default": true
    },
    "checkpointMaxEntries": {
      "title": "Checkpoint max entries",
      "type": "integer",
      "description": "Max checkpoint records kept in memory for long flows.",
      "default": 500
    },
    "deadLetterEnabled": {
      "title": "Dead-letter enabled",
      "type": "boolean",
      "description": "Persist failed jobs to dead-letter queue.",
      "default": true
    },
    "deadLetterStoreName": {
      "title": "Dead-letter store name",
      "type": "string",
      "description": "Key-value store name used for dead-letter entries.",
      "default": "SHADOW_API_DLQ"
    },
    "deadLetterMaxEntries": {
      "title": "Dead-letter max entries",
      "type": "integer",
      "description": "Maximum retained dead-letter entries.",
      "default": 1000
    },
    "deadLetterRetentionMs": {
      "title": "Dead-letter retention (ms)",
      "type": "integer",
      "description": "Expire dead-letter entries older than this age (0 disables expiry).",
      "default": 2592000000
    },
    "incidentBlockedSpikeThreshold": {
      "title": "Incident blocked spike threshold",
      "type": "integer",
      "description": "Blocked events threshold to emit critical incident.",
      "default": 5
    },
    "incidentBlockedSpikeWindowMs": {
      "title": "Incident blocked spike window (ms)",
      "type": "integer",
      "description": "Time window used to detect blocked spikes.",
      "default": 600000
    },
    "incidentWebhookUrl": {
      "title": "Incident webhook URL",
      "type": "string",
      "description": "Optional webhook endpoint for reliability incidents.",
      "default": "",
      "isSecret": true
    },
    "shutdownDrainTimeoutMs": {
      "title": "Shutdown drain timeout (ms)",
      "type": "integer",
      "description": "Max time to wait for queue drain during shutdown.",
      "default": 20000
    },
    "mockFetchDelayMs": {
      "title": "Mock fetch delay (ms)",
      "type": "integer",
      "description": "Delay used by mocked fetch worker for queue testing.",
      "default": 150
    }
  }
}
